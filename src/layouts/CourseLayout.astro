---
import Layout from './Layout.astro';
import Sidebar from '../components/Sidebar.astro';
import ThemeScript from '../components/ThemeScript.astro';
import { Header } from '../components/Header';
import { Footer } from '../components/Footer';
import TableOfContents from '../components/TableOfContents.astro';

interface Props {
  title: string;
  headings?: { depth: number; slug: string; text: string }[];
}

const { title, headings = [] } = Astro.props;
---

<Layout title={title}>
  <ThemeScript />
  <Header client:load />
  
  <!-- Main docs container - full width with fixed header offset -->
  <div class="docs-layout">
    <!-- Left Sidebar -->
    <aside class="docs-sidebar">
      <Sidebar />
    </aside>
    
    <!-- Main Content Area -->
    <main class="docs-main">
      <!-- Breadcrumbs -->
      <nav class="docs-breadcrumbs">
        <a href="/">Home</a>
        <span class="separator">/</span>
        <a href="/courses/ai-agents-engineering/">Course</a>
        <span class="separator">/</span>
        <span class="current">{title}</span>
      </nav>
      
      <!-- Article Content -->
      <article class="docs-content">
        <slot />
      </article>
    </main>

    <!-- Right TOC -->
    {headings.length > 0 && (
      <aside class="docs-toc">
        <TableOfContents headings={headings} />
      </aside>
    )}
  </div>
  
  <Footer />
</Layout>

<style>
  .docs-layout {
    display: grid;
    grid-template-columns: 280px 1fr 240px;
    min-height: calc(100vh - 60px);
    margin-top: 60px;
  }
  
  .docs-sidebar {
    position: sticky;
    top: 60px;
    height: calc(100vh - 60px);
    overflow-y: auto;
    background: var(--color-bg-secondary);
    border-right: 1px solid var(--color-border);
  }
  
  .docs-main {
    padding: 2rem 3rem;
    max-width: 900px;
    width: 100%;
  }
  
  .docs-breadcrumbs {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    font-size: 0.875rem;
    color: var(--color-text-muted);
    margin-bottom: 1.5rem;
  }
  
  .docs-breadcrumbs a {
    color: var(--color-text-muted);
    text-decoration: none;
    transition: color 0.2s;
  }
  
  .docs-breadcrumbs a:hover {
    color: var(--color-accent-cyan);
  }
  
  .docs-breadcrumbs .separator {
    opacity: 0.5;
  }
  
  .docs-breadcrumbs .current {
    color: var(--color-text-primary);
  }
  
  .docs-content {
    /* Content styles handled by prose classes */
  }
  
  .docs-toc {
    position: sticky;
    top: 60px;
    height: calc(100vh - 60px);
    overflow-y: auto;
    padding: 2rem 1rem;
    border-left: 1px solid var(--color-border);
  }
  
  /* Responsive adjustments */
  @media (max-width: 1280px) {
    .docs-layout {
      grid-template-columns: 280px 1fr;
    }
    .docs-toc {
      display: none;
    }
  }
  
  @media (max-width: 768px) {
    .docs-layout {
      grid-template-columns: 1fr;
    }
    .docs-sidebar {
      display: none;
    }
    .docs-main {
      padding: 1.5rem;
    }
  }
</style>
